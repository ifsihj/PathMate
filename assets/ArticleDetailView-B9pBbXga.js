import{_ as L,r as _,j as x,b as D,c as l,a as t,m as k,t as n,F as p,f as g,n as I,A as B,B as S,C as N,k as V,v as d,u as j,o as c}from"./index-kcQoswnZ.js";const F={class:"article-detail"},M={class:"article-content"},z={key:0,class:"article-cover"},J=["src","alt"],O={class:"article-header"},K={class:"article-title"},R={class:"article-meta"},U={class:"author-info"},E=["src","alt"],T={key:1,class:"author-avatar-placeholder"},q={class:"author-name"},G={class:"article-date"},H={class:"article-body"},P={class:"article-interaction"},Q=["fill"],W={class:"interaction-btn"},X={class:"comments-section"},Y={class:"comments-title"},Z={class:"comment-input"},$=["disabled"],tt={class:"comments-list"},et={class:"comment-avatar"},st={class:"comment-content"},ot={class:"comment-header"},at={class:"comment-user"},nt={class:"comment-time"},it={class:"comment-text"},lt={key:0,class:"no-comments"},ct={__name:"ArticleDetailView",setup(rt){const w=j(),f=V(),e=_({id:"",title:"",author:"",authorAvatar:null,coverImage:null,content:"",createdAt:Date.now(),likeCount:0,isLiked:!1,comments:[]}),r=_(""),y=x(()=>e.value.content?e.value.content.split(`
`).filter(i=>i.trim()):[]),C=()=>{const i=f.params.id,s=localStorage.getItem("discovery-article-items");if(s)try{const a=JSON.parse(s).find(b=>b.id===parseInt(i));a?e.value={...a,likeCount:a.likeCount||0,isLiked:a.isLiked||!1,comments:a.comments||[],createdAt:a.createdAt||Date.now()}:(d.error("文章不存在"),u())}catch(o){console.error("Failed to load article:",o),d.error("加载文章失败"),u()}else d.error("没有找到文章"),u()},v=i=>new Date(i).toLocaleString(),A=()=>{e.value.isLiked=!e.value.isLiked,e.value.likeCount+=e.value.isLiked?1:-1,h(),d.success(e.value.isLiked?"点赞成功":"取消点赞")},m=()=>{if(!r.value.trim())return;const i={id:Date.now(),user:"当前用户",content:r.value.trim(),createdAt:Date.now()};e.value.comments.push(i),r.value="",h(),d.success("评论成功")},h=()=>{const i=localStorage.getItem("discovery-article-items");if(i)try{const s=JSON.parse(i),o=s.findIndex(a=>a.id===e.value.id);o!==-1&&(s[o]=e.value,localStorage.setItem("discovery-article-items",JSON.stringify(s)))}catch(s){console.error("Failed to save article:",s)}},u=()=>{w.go(-1)};return D(()=>{C()}),(i,s)=>(c(),l("div",F,[t("div",{class:"back-section"},[t("button",{class:"back-btn",onClick:u},[...s[1]||(s[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"15 18 9 12 15 6"})],-1),t("span",null,"返回",-1)])])]),t("div",M,[e.value.coverImage?(c(),l("div",z,[t("img",{src:e.value.coverImage,alt:e.value.title,class:"cover-img"},null,8,J)])):k("",!0),t("div",O,[t("h1",K,n(e.value.title),1),t("div",R,[t("div",U,[e.value.authorAvatar?(c(),l("img",{key:0,src:e.value.authorAvatar,alt:e.value.author,class:"author-avatar"},null,8,E)):(c(),l("div",T,n(e.value.author?.charAt(0)||"U"),1)),t("span",q,n(e.value.author),1)]),t("div",G,n(v(e.value.createdAt)),1)])]),t("div",H,[(c(!0),l(p,null,g(y.value,(o,a)=>(c(),l("p",{key:a,class:"body-line"},n(o),1))),128))]),t("div",P,[t("button",{class:I(["interaction-btn",{liked:e.value.isLiked}]),onClick:A},[(c(),l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:e.value.isLiked?"currentColor":"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon"},[...s[2]||(s[2]=[t("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"},null,-1)])],8,Q)),t("span",null,n(e.value.likeCount),1)],2),t("button",W,[s[3]||(s[3]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon"},[t("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})],-1)),t("span",null,n(e.value.comments.length),1)])]),t("div",X,[t("h3",Y,"评论 ("+n(e.value.comments.length)+")",1),t("div",Z,[B(t("textarea",{"onUpdate:modelValue":s[0]||(s[0]=o=>r.value=o),placeholder:"写下你的评论...",onKeyup:N(m,["enter"])},null,544),[[S,r.value]]),t("button",{class:"submit-comment",onClick:m,disabled:!r.value.trim()}," 发送 ",8,$)]),t("div",tt,[(c(!0),l(p,null,g(e.value.comments,(o,a)=>(c(),l("div",{key:a,class:"comment-item"},[t("div",et,n(o.user.charAt(0)),1),t("div",st,[t("div",ot,[t("span",at,n(o.user),1),t("span",nt,n(v(o.createdAt)),1)]),t("div",it,n(o.content),1)])]))),128)),e.value.comments.length===0?(c(),l("div",lt," 暂无评论，快来发表你的看法吧！ ")):k("",!0)])])])]))}},ut=L(ct,[["__scopeId","data-v-13bf5988"]]);export{ut as default};
