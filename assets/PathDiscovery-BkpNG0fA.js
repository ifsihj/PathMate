import{_ as V,r as h,j as O,y as T,b as K,c as i,a as l,m as I,d as s,t as L,w as n,e as c,F as q,f as F,i as z,k as E,u as W,o as r,h as P,p as U,v as p,M as Z}from"./index-kcQoswnZ.js";import{D as $}from"./DiscoveryCard-DAYZeJFw.js";const G={class:"path-discovery"},H={class:"upload-section"},Q={key:0,class:"search-result-header"},X={class:"search-info"},Y={class:"search-keyword"},ee={class:"result-count"},te={key:1,class:"content-feed"},ae={key:2,class:"no-results"},oe={class:"no-results-content"},se={key:3,class:"content-feed"},le={key:0},ne={__name:"PathDiscovery",setup(re){const y=W(),_=E(),m=h(!1),t=h({title:"",content:"",coverFileList:[],topicStatus:"",existingMembers:"",memberRequirements:""}),d=h([{id:1,title:"信息架构小组 找3人!!!",author:"Zed",authorAvatar:"/src/assets/images/avatar1.webp",coverImage:"/src/assets/images/help.jpg",content:`选题情况:暂未选题
已有队员:信息管理系三名大二学生,掌握一定信息行为、信息组织相关知识,正在学习Java前端开发以及数据库系统相关课程
成员要求:
1.同为北京大学学生
2.态度认真,愿意听取建议
3.能够全程参与项目,包括Java和数据库系统的开发`},{id:2,title:"数字人文平台 挑战杯组队~",author:"木头",authorAvatar:"/src/assets/images/avatar2.webp",coverImage:"/src/assets/images/help2.png",content:`选题情况:数字人文平台,具体主题组队完成商榷
已有队员:信息管理系大三学生,文科生,喜爱中国历史,选修数据库系统、Java、信架构等专业课,有搭建数字人文平台经历,在信管位老师课题组中。
指导老师:信息管理系位通老师
成员要求:
1.1=3
2.同为北京大学学生,希望是信科/信管/中文/历史系的同学`}]),B=a=>a.type.startsWith("image/")?(a.size/1024/1024<2||p.error("图片大小不能超过 2MB!"),!1):(p.error("只能上传图片文件!"),!1),N=()=>{},R=()=>{if(!t.value.title.trim()){p.warning("请输入标题");return}if(!t.value.content.trim()){p.warning("请输入内容描述");return}let a=t.value.content;t.value.topicStatus&&(a=`选题情况:${t.value.topicStatus}
${a}`),t.value.existingMembers&&(a=`${a}
已有队员:${t.value.existingMembers}`),t.value.memberRequirements&&(a=`${a}
成员要求:
${t.value.memberRequirements}`);const e={id:Date.now(),title:t.value.title,author:"当前用户",authorAvatar:null,coverImage:t.value.coverFileList[0]?.thumbUrl||null,content:a};d.value.unshift(e),D(),p.success("发布成功!"),x(),m.value=!1},x=()=>{t.value={title:"",content:"",coverFileList:[],topicStatus:"",existingMembers:"",memberRequirements:""}},k=a=>{console.log("点击了卡片:",a)},b=(a,e)=>{a==="chat"?y.push({path:"/chat",query:{userId:`user-${e.author}`,userName:e.author,context:`关于 "${e.title}"`}}):a==="apply"&&Z.confirm({title:"申请加入 Path",content:`您确定要申请加入 "${e.title}" 吗？`,okText:"确定申请",cancelText:"取消",onOk(){p.success("申请已提交，等待审核中...")}})},u=h(""),C=()=>{u.value=_.query.search||""},f=O(()=>{if(!u.value)return d.value;const a=u.value.toLowerCase().trim();return d.value.filter(e=>e.title.toLowerCase().includes(a))}),S=()=>{y.push({name:"discovery-path"}),u.value=""},D=()=>{localStorage.setItem("discovery-path-items",JSON.stringify(d.value))};return T(()=>_.query.search,()=>{C()},{immediate:!0}),K(()=>{const a=localStorage.getItem("discovery-path-items");if(a)try{const e=JSON.parse(a);d.value=e}catch(e){console.error("Failed to load path items:",e)}C()}),(a,e)=>{const w=c("a-button"),M=c("a-input"),v=c("a-form-item"),A=c("a-upload"),g=c("a-textarea"),j=c("a-form"),J=c("a-modal");return r(),i("div",G,[l("div",H,[l("button",{class:"upload-btn",onClick:e[0]||(e[0]=o=>m.value=!0)},[...e[8]||(e[8]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),l("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),l("span",null,"发布 Path",-1)])])]),u.value?(r(),i("div",Q,[l("div",X,[l("span",Y,'搜索关键词: "'+L(u.value)+'"',1),l("span",ee,"找到 "+L(f.value.length)+" 个 Path",1)]),s(w,{type:"link",onClick:S},{default:n(()=>[...e[9]||(e[9]=[P("清除搜索",-1)])]),_:1})])):I("",!0),f.value.length>0?(r(),i("div",te,[(r(!0),i(q,null,F(f.value,o=>(r(),U($,{key:o.id,item:o,"show-actions":!0,"action-buttons":{chat:!0,apply:!0},onClick:k,onAction:b},null,8,["item"]))),128))])):u.value?(r(),i("div",ae,[l("div",oe,[e[11]||(e[11]=z('<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-4e0af602><circle cx="11" cy="11" r="8" data-v-4e0af602></circle><line x1="21" y1="21" x2="16.65" y2="16.65" data-v-4e0af602></line></svg><p class="no-results-text" data-v-4e0af602>未找到相关 Path</p><p class="no-results-hint" data-v-4e0af602>尝试使用其他关键词搜索</p>',3)),s(w,{type:"primary",onClick:S},{default:n(()=>[...e[10]||(e[10]=[P("清除搜索",-1)])]),_:1})])])):(r(),i("div",se,[(r(!0),i(q,null,F(d.value,o=>(r(),U($,{key:o.id,item:o,"show-actions":!0,"action-buttons":{chat:!0,apply:!0},onClick:k,onAction:b},null,8,["item"]))),128))])),s(J,{open:m.value,"onUpdate:open":e[7]||(e[7]=o=>m.value=o),title:"发布新的 Path",width:600,onOk:R,onCancel:x},{default:n(()=>[s(j,{model:t.value,"label-col":{span:6},"wrapper-col":{span:18}},{default:n(()=>[s(v,{label:"标题",required:""},{default:n(()=>[s(M,{value:t.value.title,"onUpdate:value":e[1]||(e[1]=o=>t.value.title=o),placeholder:"请输入 Path 标题",maxlength:50,"show-count":""},null,8,["value"])]),_:1}),s(v,{label:"封面图"},{default:n(()=>[s(A,{"file-list":t.value.coverFileList,"onUpdate:fileList":e[2]||(e[2]=o=>t.value.coverFileList=o),"list-type":"picture-card","before-upload":B,onPreview:N},{default:n(()=>[t.value.coverFileList.length<1?(r(),i("div",le,[...e[12]||(e[12]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),l("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),l("div",{style:{"margin-top":"8px"}},"上传封面",-1)])])):I("",!0)]),_:1},8,["file-list"])]),_:1}),s(v,{label:"内容描述",required:""},{default:n(()=>[s(g,{value:t.value.content,"onUpdate:value":e[3]||(e[3]=o=>t.value.content=o),placeholder:"请输入 Path 的详细描述...",rows:6,maxlength:1e3,"show-count":""},null,8,["value"])]),_:1}),s(v,{label:"选题情况"},{default:n(()=>[s(M,{value:t.value.topicStatus,"onUpdate:value":e[4]||(e[4]=o=>t.value.topicStatus=o),placeholder:"例如：暂未选题"},null,8,["value"])]),_:1}),s(v,{label:"已有队员"},{default:n(()=>[s(g,{value:t.value.existingMembers,"onUpdate:value":e[5]||(e[5]=o=>t.value.existingMembers=o),placeholder:"描述已有队员情况...",rows:3},null,8,["value"])]),_:1}),s(v,{label:"成员要求"},{default:n(()=>[s(g,{value:t.value.memberRequirements,"onUpdate:value":e[6]||(e[6]=o=>t.value.memberRequirements=o),placeholder:"描述对成员的要求...",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])])}}},ce=V(ne,[["__scopeId","data-v-4e0af602"]]);export{ce as default};
