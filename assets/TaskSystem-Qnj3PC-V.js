import{q as ie,r as y,s as m,j as re,b as de,c as d,a as o,d as s,e as c,m as $,F as O,f as E,w as i,v as A,t as C,h as f,x as U,o as u,_ as z}from"./index-kcQoswnZ.js";import{_ as V,a as Y,b as q}from"./avatar3-BwvAMD8z.js";const ue={class:"calendar-container"},ce={class:"layout-wrapper"},ve={class:"tasks-section"},pe={class:"tasks-header"},_e={class:"tasks-list"},me={key:0,class:"empty-state"},ge=["onClick"],fe={class:"task-avatar"},ye=["alt"],ke=["alt"],be=["alt"],he={key:3,class:"avatar-placeholder"},we={class:"task-badge"},Ce={class:"task-content"},De={class:"task-title"},xe={class:"task-meta"},Te={class:"task-date"},Se={key:0,class:"task-assignee"},Le={key:1,class:"task-desc"},Me={class:"task-actions"},$e={class:"calendar-section"},Ae={class:"events"},Ue=["onClick"],je={key:0,class:"notes-month"},Be=ie({__name:"Calendar",setup(J){const D=y(m()),_=y(!1),k=y(null),h=y(null),w=y(-1),v=y(new Map),n=y({content:"",type:"success",description:"",assignee:"",avatar:null}),R=()=>{const t=localStorage.getItem("calendar-tasks");if(t)try{const e=JSON.parse(t);v.value=new Map(Object.entries(e))}catch(e){console.error("Failed to load tasks:",e)}},B=()=>{const t=Object.fromEntries(v.value);localStorage.setItem("calendar-tasks",JSON.stringify(t))},S=t=>t.format("YYYY-MM-DD"),H=t=>{const e=S(t);return v.value.get(e)||[]},F=t=>{let e=0;const l=t.year(),p=t.month();return v.value.forEach((r,b)=>{const x=m(b);x.year()===l&&x.month()===p&&(e+=r.length)}),e>0?e:0},j=re(()=>{const t=[];return v.value.forEach(e=>{t.push(...e)}),t.sort((e,l)=>{const p=m(e.date),r=m(l.date);return p.isBefore(r)?-1:p.isAfter(r)?1:0})}),P=t=>{const e=m(t),l=m(),p=l.add(1,"day");return e.isSame(l,"day")?"今天":e.isSame(p,"day")?"明天":(e.isBefore(l,"day"),e.format("MM月DD日"))},G=t=>{D.value=m(t)},K=t=>{const e=m(t.date),l=S(e),r=(v.value.get(l)||[]).findIndex(b=>b.id===t.id);r>=0&&(k.value=t,h.value=e,w.value=r,n.value={content:t.content,type:t.type,description:t.description||"",assignee:t.assignee||"",avatar:t.avatar||null},_.value=!0,D.value=e)},Q=t=>{const e=m(t.date);I(e,t.id)},W=(t,{source:e})=>{e==="date"&&(k.value=null,h.value=t,w.value=-1,n.value={content:"",type:"success",description:"",assignee:"",avatar:null},_.value=!0)},X=(t,e,l)=>{k.value=e,h.value=t,w.value=l,n.value={content:e.content,type:e.type,description:e.description||"",assignee:e.assignee||"",avatar:e.avatar||null},_.value=!0},I=(t,e)=>{const l=S(t),r=(v.value.get(l)||[]).filter(b=>b.id!==e);r.length===0?v.value.delete(l):v.value.set(l,r),B(),A.success("任务已删除")},Z=()=>{if(!n.value.content.trim()){A.warning("请输入任务标题");return}if(!h.value)return;const t=S(h.value),e=v.value.get(t)||[];if(k.value&&w.value>=0){const l={...k.value,content:n.value.content,type:n.value.type,description:n.value.description||void 0,assignee:n.value.assignee||void 0,avatar:n.value.avatar||void 0};e[w.value]=l,v.value.set(t,e),A.success("任务已更新")}else{const l={id:`${t}-${Date.now()}`,content:n.value.content,type:n.value.type,description:n.value.description||void 0,assignee:n.value.assignee||void 0,avatar:n.value.avatar||void 0,date:t};e.push(l),v.value.set(t,e),A.success("任务已添加")}B(),N()},N=()=>{_.value=!1,k.value=null,h.value=null,w.value=-1,n.value={content:"",type:"success",description:"",assignee:"",avatar:null}};return de(()=>{R()}),(t,e)=>{const l=c("a-badge"),p=c("a-empty"),r=c("a-button"),b=c("a-calendar"),x=c("a-input"),T=c("a-form-item"),L=c("a-select-option"),ee=c("a-select"),M=c("a-radio-button"),te=c("a-radio-group"),ae=c("a-textarea"),se=c("a-form"),ne=c("a-modal");return u(),d("div",ue,[o("div",ce,[o("div",ve,[o("div",pe,[e[7]||(e[7]=o("h3",{class:"section-title"},"任务列表",-1)),s(l,{count:j.value.length,"number-style":{backgroundColor:"#52c41a"}},null,8,["count"])]),o("div",_e,[j.value.length===0?(u(),d("div",me,[s(p,{description:"暂无任务，点击日历日期添加任务"})])):$("",!0),(u(!0),d(O,null,E(j.value,a=>(u(),d("div",{key:a.id,class:"task-item",onClick:g=>G(a.date)},[o("div",fe,[a.avatar==="avatar1.webp"?(u(),d("img",{key:0,src:V,alt:a.assignee||"负责人",class:"avatar-img"},null,8,ye)):a.avatar==="avatar2.webp"?(u(),d("img",{key:1,src:Y,alt:a.assignee||"负责人",class:"avatar-img"},null,8,ke)):a.avatar==="avatar3.jpg"?(u(),d("img",{key:2,src:q,alt:a.assignee||"负责人",class:"avatar-img"},null,8,be)):(u(),d("div",he,C((a.assignee||"未").charAt(0)),1))]),o("div",we,[s(l,{status:a.type},null,8,["status"])]),o("div",Ce,[o("div",De,C(a.content),1),o("div",xe,[o("span",Te,C(P(a.date)),1),a.assignee?(u(),d("span",Se,"负责人: "+C(a.assignee),1)):$("",!0),a.description?(u(),d("span",Le,C(a.description),1)):$("",!0)])]),o("div",Me,[s(r,{type:"text",size:"small",onClick:U(g=>K(a),["stop"]),class:"edit-btn"},{default:i(()=>[...e[8]||(e[8]=[f(" 编辑 ",-1)])]),_:1},8,["onClick"]),s(r,{type:"text",danger:"",size:"small",onClick:U(g=>Q(a),["stop"]),class:"delete-btn-list"},{default:i(()=>[...e[9]||(e[9]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])])],8,ge))),128))])]),o("div",$e,[s(b,{value:D.value,"onUpdate:value":e[0]||(e[0]=a=>D.value=a),onSelect:W,class:"beautiful-calendar"},{dateCellRender:i(({current:a})=>[o("ul",Ae,[(u(!0),d(O,null,E(H(a),(g,le)=>(u(),d("li",{key:g.id,class:"event-item",onClick:U(oe=>X(a,g,le),["stop"])},[s(l,{status:g.type,text:g.content},null,8,["status","text"]),s(r,{type:"text",danger:"",size:"small",class:"delete-btn",onClick:U(oe=>I(a,g.id),["stop"])},{default:i(()=>[...e[10]||(e[10]=[f(" × ",-1)])]),_:1},8,["onClick"])],8,Ue))),128))])]),monthCellRender:i(({current:a})=>[F(a)?(u(),d("div",je,[o("section",null,C(F(a)),1),e[11]||(e[11]=o("span",null,"任务数量",-1))])):$("",!0)]),_:1},8,["value"])])]),s(ne,{open:_.value,"onUpdate:open":e[6]||(e[6]=a=>_.value=a),title:k.value?"编辑任务":"添加 DDL/任务",onOk:Z,onCancel:N},{default:i(()=>[s(se,{model:n.value,"label-col":{span:6},"wrapper-col":{span:18}},{default:i(()=>[s(T,{label:"任务标题",required:""},{default:i(()=>[s(x,{value:n.value.content,"onUpdate:value":e[1]||(e[1]=a=>n.value.content=a),placeholder:"请输入任务标题",maxlength:50,"show-count":""},null,8,["value"])]),_:1}),s(T,{label:"任务类型",required:""},{default:i(()=>[s(ee,{value:n.value.type,"onUpdate:value":e[2]||(e[2]=a=>n.value.type=a),placeholder:"请选择任务类型"},{default:i(()=>[s(L,{value:"success"},{default:i(()=>[...e[12]||(e[12]=[f("普通任务",-1)])]),_:1}),s(L,{value:"warning"},{default:i(()=>[...e[13]||(e[13]=[f("重要任务",-1)])]),_:1}),s(L,{value:"error"},{default:i(()=>[...e[14]||(e[14]=[f("紧急 DDL",-1)])]),_:1}),s(L,{value:"processing"},{default:i(()=>[...e[15]||(e[15]=[f("进行中",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),s(T,{label:"负责人"},{default:i(()=>[s(x,{value:n.value.assignee,"onUpdate:value":e[3]||(e[3]=a=>n.value.assignee=a),placeholder:"请输入负责人姓名（可选）",maxlength:20},null,8,["value"])]),_:1}),s(T,{label:"负责人头像"},{default:i(()=>[s(te,{value:n.value.avatar,"onUpdate:value":e[4]||(e[4]=a=>n.value.avatar=a)},{default:i(()=>[s(M,{value:"avatar1.webp"},{default:i(()=>[...e[16]||(e[16]=[o("img",{src:V,alt:"头像1",class:"avatar-option"},null,-1)])]),_:1}),s(M,{value:"avatar2.webp"},{default:i(()=>[...e[17]||(e[17]=[o("img",{src:Y,alt:"头像2",class:"avatar-option"},null,-1)])]),_:1}),s(M,{value:"avatar3.jpg"},{default:i(()=>[...e[18]||(e[18]=[o("img",{src:q,alt:"头像3",class:"avatar-option"},null,-1)])]),_:1}),s(M,{value:null},{default:i(()=>[...e[19]||(e[19]=[f("无头像",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),s(T,{label:"任务描述"},{default:i(()=>[s(ae,{value:n.value.description,"onUpdate:value":e[5]||(e[5]=a=>n.value.description=a),placeholder:"请输入任务描述（可选）",rows:3,maxlength:200,"show-count":""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Fe=z(Be,[["__scopeId","data-v-3c97f360"]]),Ie={class:"task-system"},Ne={class:"white-wrapper"},Oe={class:"content-wrapper"},Ee={__name:"TaskSystem",setup(J){return y([{id:1,title:"绘制网站地图",avatar:"LeaderAvatar"},{id:2,title:"绘制线框图",avatar:"StarAvatar"},{id:3,title:"绘制内容映射",avatar:"CatAvatar"}]),(D,_)=>(u(),d("div",Ie,[_[0]||(_[0]=o("div",{class:"page-header"},[o("h1",{class:"page-title"},"PATH MATE")],-1)),o("div",Ne,[o("div",Oe,[s(Fe)])])]))}},qe=z(Ee,[["__scopeId","data-v-bdcdf977"]]);export{qe as default};
